# Generic metadata about this project
name: fulcrum_prefect
prefect-version: 3.1.7

pull:
  - prefect.deployments.steps.set_working_directory:
      directory: /opt/prefect/fulcrum_prefect

# the definitions section allows you to provide reusable definitions for your project
definitions:
  work_pools:
    ecs_work_pool: &ecs_work_pool
      name: ecs-pool
      work_queue_name: default
      job_variables:
        image: "{{ $IMAGE_URI }}:{{ $TAG }}"
  schedules:
    daily_midnight: &daily_midnight
      - cron: "0 0 * * *"
        timezone: "UTC"

# the deployments section allows you to provide configuration for deploying flows
deployments:
  - name: "Growth Rates"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Growth Rates"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "GROWTH_RATES"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Trend Changes"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Trend Changes"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "TREND_CHANGES"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Trend Exceptions"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Trend Exceptions"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "TREND_EXCEPTIONS"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Long Range"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Long Range"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "LONG_RANGE"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Goal vs Actual"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Goal vs Actual"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "GOAL_VS_ACTUAL"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Likely Status"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Likely Status"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "LIKELY_STATUS"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Record Values"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Record Values"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "RECORD_VALUES"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Status Change"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Status Change"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "STATUS_CHANGE"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Segment Drift"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Segment Drift"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "SEGMENT_DRIFT"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Influence Drift"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Influence Drift"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "INFLUENCE_DRIFT"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Required Performance"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Required Performance"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "REQUIRED_PERFORMANCE"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Significant Segments"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Significant Segments"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "SIGNIFICANT_SEGMENTS"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight

  - name: "Component Drift"
    version: "1.0.0"
    tags:
      - daily
      - story-generation
    description: "Generate stories for Component Drift"
    entrypoint: fulcrum_prefect.gen_stories:generate_stories
    parameters:
      group: "COMPONENT_DRIFT"
    work_pool: *ecs_work_pool
    schedules: *daily_midnight
